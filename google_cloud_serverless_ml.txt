import requests
import pickle
from google.cloud import storage

def hello_world(request):
    """Responds to any HTTP request.
    Args:
        request (flask.Request): HTTP request object.
    Returns:
        The response text or any set of values that can be turned into a
        Response object using
        `make_response <http://flask.pocoo.org/docs/1.0/api/#flask.Flask.make_response>`.
    """
    request_data = request.get_json()
    storage_client = storage.Client()
    bucket = storage_client.get_bucket('fx-model')
    blob_classifier = bucket.blob('classifier.pickle')
    blob_classifier.download_to_filename('/tmp/classifier.pickle')
    blob_scaler = bucket.blob('sc.pickle')
    blob_scaler.download_to_filename('/tmp/sc.pickle')
    serverless_classifier = pickle.load(open('/tmp/classifier.pickle','rb'))
    serverless_scaler = pickle.load(open('/tmp/sc.pickle','rb'))
    age = request_data['age']
    salary = request_data['salary']
    pred_proba = serverless_classifier.predict_proba(serverless_scaler.transform(np.array([[age,salary]])))[:,1]
    return "The prediction is {}".format(pred_proba)
	
	
	
###########################################################3
	
{
"age":"40",
"salary":"20000"
}


# Function dependencies, for example:
# package>=version
requests==2.22.0
scikit-learn==0.21.3
google-cloud-storage==1.17.0


